Emailer - Утилита для отправки email
📋 Описание
Emailer - это легковесная утилита для автоматической отправки email сообщений. Приложение работает в фоновом режиме без отображения окон.

🚀 Основные функции
✅ Отправка email через SMTP

✅ Автоматическое скрытие консоли

✅ Хранение настроек в реестре Windows 

✅ Логирование операций

✅ Поддержка UTF-8 кодировки

✅ Разовая отправка с автоматическим завершением

📁 Структура проекта
Исходные файлы
text
Emailer/
├── Program.vb              # Основной код приложения
├── README.md               # Эта документация
└── emailer.ini            # Файл с темой письма
Генерируемые файлы
text
Emailer/
├── Emailer.exe            # Исполняемый файл
├── emailer.log           # Лог успешных операций
├── emailer_error.log     # Лог ошибок
└── emailer.ini           # Тема письма (создается автоматически)
⚙️ Настройки в реестре
Приложение хранит настройки в реестре по пути:

text
HKEY_CURRENT_USER\Software\Emailer
Параметры реестра:
Параметр	Значение по умолчанию	Описание
Secret	(пусто)	Пароль для SMTP аутентификации
Username	DOMAIN\user	Имя пользователя SMTP
SmtpServer	mail.domain.ru	SMTP сервер
SmtpPort	587	Порт SMTP сервера
FromEmail	account@domain.ru	Email отправителя
ToEmail	account@domain.ru	Email получателя
Файл emailer.ini
Содержит тему письма в виде простого текста:

text
Locked
🛠️ Сборка и запуск
Требования
.NET Framework 4.7.2 или .NET 8.0

Visual Studio 2022 (для сборки)

Сборка
Откройте проект в Visual Studio

Выберите конфигурацию Release

Build → Build Solution (Ctrl+Shift+B)

Первоначальная настройка
Запустите Emailer.exe

Приложение создаст настройки по умолчанию в реестре

Отредактируйте параметры в реестре через regedit:

cmd
regedit
Настройка пароля
cmd
# Через реестр
reg add "HKEY_CURRENT_USER\Software\Emailer" /v Secret /t REG_SZ /d "your_password"
📧 Формат отправляемого письма
Тема: {Тема из emailer.ini}: {Имя компьютера}

Тело письма:

text
Уведомление от Emailer

Компьютер: {Имя компьютера}
Пользователь: {Текущий пользователь}
Время: {Время отправки}
SMTP сервер: {SMTP сервер}:{порт}
SMTP пользователь: {SMTP пользователь}
🔧 Особенности реализации
Безопасность
Пароль хранится в реестре, а не в открытом файле

Приложение не отображает окна

Логи не содержат конфиденциальную информацию

Надежность
Автоматическое создание настроек по умолчанию

Обработка ошибок с записью в лог

Кодировка UTF-8 для поддержки русского языка

Производительность
Минимальное потребление ресурсов

Мгновенное выполнение

Автоматическое завершение после отправки

📝 Логирование
Приложение создает два лог-файла:

emailer.log - успешные операции отправки

emailer_error.log - ошибки и проблемы

Формат логов: ГГГГ-ММ-ДД ЧЧ:мм:сс - Сообщение

🐛 Устранение проблем
Письмо не отправляется
Проверьте правильность пароля в реестре

Убедитесь в доступности SMTP сервера

Проверьте файл emailer_error.log

Приложение не запускается
Убедитесь, что установлен .NET Framework 4.7.2+

Проверьте права доступа к реестру

Убедитесь, что предыдущий процесс завершен

Изменение темы письма
Откройте файл emailer.ini

Измените текст темы

Сохраните файл

🔄 Работа с реестром
Просмотр текущих настроек
cmd
reg query "HKEY_CURRENT_USER\Software\Emailer"
Изменение SMTP сервера
cmd
reg add "HKEY_CURRENT_USER\Software\Emailer" /v SmtpServer /t REG_SZ /d "new.smtp.server.com"
Сброс настроек
Удалите раздел реестра:

cmd
reg delete "HKEY_CURRENT_USER\Software\Emailer" /f
📄 Лицензия
Приложение предназначено для внутреннего использования.

👨‍💻 Разработчик
Разработано с использованием Visual Basic .NET

Последнее обновление: 2025