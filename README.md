# Emailer - Программа для автоматической отправки email уведомлений
# Версия 1.0

## ОБЗОР

Emailer - приложение для автоматической отправки email уведомлений со скрытым интерфейсом. 
Используется в системах мониторинга и автоматизированных задачах.

Назначение:
- Мониторинг рабочих станций
- Уведомления о задачах
- Системные отчеты
- Интеграция с IT-инфраструктурой

## ЛОГИКА РАБОТЫ

1. Запуск приложения и скрытие консольного окна
2. Чтение настроек SMTP из реестра Windows
3. Загрузка темы письма из файла emailer.ini
4. Сбор системной информации:
   - Имя компьютера
   - Текущий пользователь
   - Доменная информация
   - Временная метка
5. Установка SSL соединения с SMTP сервером
6. Аутентификация с использованием учетных данных
7. Формирование и отправка email сообщения
8. Логирование результата операции
9. Автоматическое завершение работы

## ОСОБЕННОСТИ

- Отправка через SMTP с SSL/TLS шифрованием
- Автоматическое скрытие интерфейса
- Сбор детальной системной информации
- Хранение настроек в реестре Windows
- Поддержка параметров командной строки
- Детальное логирование в файлы
- Обработка ошибок на всех этапах

## СИСТЕМНЫЕ ТРЕБОВАНИЯ

### Операционные системы:
- Windows 10 / 11 (все редакции)
- Windows Server 2016 / 2019 / 2022
- Windows 8.1 / Windows 7 SP1

### Разрядность:
- 32-бит (x86) системы
- 64-бит (x64) системы
- Поддержка архитектуры AnyCPU

### Требования:
- .NET Framework 4.6.1 или выше
- Доступ к интернету для SMTP
- Права на запись в реестр и файловую систему
- Разрешение на исходящие соединения на порт 587

## УСТАНОВКА

1. Скопируйте Emailer.exe в целевую папку
2. Запустите программу для создания начальных настроек
3. Настройте параметры SMTP в реестре Windows
4. Настройте тему письма в файле emailer.ini

## КОНФИГУРАЦИЯ

### Настройки в реестре:
Путь: HKEY_CURRENT_USER\Software\Emailer

Обязательные параметры:
- Secret - пароль для SMTP аутентификации
- Username - учетная запись (формат: DOMAIN\user)
- SmtpServer - адрес SMTP сервера
- SmtpPort - порт SMTP (рекомендуется 587)
- FromEmail - email отправителя
- ToEmail - email получателя

### Файл конфигурации:
emailer.ini - содержит тему письма, по умолчанию "Subject_demo"

### Настройки для почтовых сервисов:

Gmail:
SmtpServer: smtp.gmail.com
SmtpPort: 587
Username: ваш_email@gmail.com
Secret: пароль приложения

Yandex:
SmtpServer: smtp.yandex.ru
SmtpPort: 587
Username: ваш_логин
Secret: пароль приложения

Mail.ru:
SmtpServer: smtp.mail.ru
SmtpPort: 587
Username: полный_email@mail.ru
Secret: пароль приложения

## ИСПОЛЬЗОВАНИЕ

### Базовый запуск:
Emailer.exe

### Параметры командной строки:
/subject или /s - установка темы письма
Пример: Emailer.exe /subject "Мониторинг системы"

/debug - включение режима отладки
Пример: Emailer.exe /debug /subject "Тестирование"

### Интеграция с планировщиком задач:
Программа: C:\Program Files\Emailer\Emailer.exe
Аргументы: /subject "Ежедневный отчет"

### Типовые сценарии использования:
- Ежедневная отчетность: /subject "Ежедневный системный отчет"
- Мониторинг доступности: /subject "Запуск рабочей станции"
- Уведомления о задачах: /subject "Задача выполнена успешно"
- Аварийные оповещения: /subject "КРИТИЧЕСКАЯ ОШИБКА"

## ЛОГИРОВАНИЕ

Программа создает два файла логов:

emailer.log - успешные операции:
2024-01-15 14:30:25 - Письмо отправлено: Мониторинг системы

emailer_error.log - ошибки и предупреждения:
2024-01-15 14:29:33 - Ошибка аутентификации SMTP

## УСТРАНЕНИЕ НЕИСПРАВНОСТЕЙ

### Распространенные проблемы:
- "Пароль не настроен в реестре" - настройте параметр Secret
- "Требуется безопасное соединение" - проверьте SSL и порт
- "Ошибка аутентификации" - проверьте учетные данные
- "Таймаут соединения" - проверьте доступность SMTP сервера

### Команды диагностики:
telnet smtp.server.com 587
reg query "HKEY_CURRENT_USER\Software\Emailer"

## ЧАСТО ЗАДАВАЕМЫЕ ВОПРОСЫ

В: Программа не отправляет письма, что проверить?
О: Логи ошибок, настройки SMTP, интернет-соединение, брандмауэр

В: Как изменить тему письма?
О: Через файл emailer.ini или параметр /subject в командной строке

В: Как убедиться, что программа работает?
О: Проверьте файлы emailer.log и emailer_error.log после запуска

В: Поддерживаются ли доменные учетные записи?
О: Да, в формате DOMAIN\username

В: Можно ли использовать в автоматических сценариях?
О: Да, программа идеально подходит для планировщика задач и скриптов